<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>尋找微笑之心</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div id="game-container">
        <header>
            <h1>尋找微笑之心</h1>
            <p>循著靴上微笑的指引，拼湊出匠心地圖，理解「微笑之心」的真諦。</p>
            
            <button id="toggle-story-button" class="story-toggle-button">
                閱讀【緣起：爺爺的藏寶圖】故事
                <span class="arrow">▼</span>
            </button>
            
            <div class="story-origin">
                <h4>【緣起：爺爺的藏寶圖】</h4>
                <p>在一個充滿舊物氣息的閣樓裡，年輕的設計師阿明發現了爺爺留下的一個木箱。箱子裡沒有金銀珠寶，而是一雙作工精緻、皮革柔軟的短靴，以及一張泛黃的羊皮卷。</p>
                <p>靴子的線條優美，皮革觸感溫潤，在靴子的內側，阿明發現烙印著一個小小的微笑標誌。他拿起那張羊皮卷，上面寫著一段謎語：</p>
                <p>「孩子，你找到了我的『旅人之靴』。但穿上它，不代表你真正擁有它。這雙靴子承載的，是名為『信賴』的重量與一份最真誠的驕傲。它，就是『微笑之心』。循著靴上微笑的指引，去尋找它誕生的根源，去尋找更多優秀的MIT產品的吧，當你理解了『微笑之心』的真諦，這雙靴子才能真正帶你走向未來......」</p>
            </div>

            <p class="main-scan-prompt">請使用手機相機或任何掃碼 App，掃描店家現場的 QR Code 來參與活動。</p>
        </header>

        <main id="main-content">
            <section id="map-section">
                <h2>匠心地圖</h2>
                <div id="map-board">
                    <div class="map-piece" data-piece-id="M01"><img src="images/M01.png" alt="匠心碎片1" loading="lazy"></div>
                    <div class="map-piece" data-piece-id="M02"><img src="images/M02.png" alt="匠心碎片2" loading="lazy"></div>
                    <div class="map-piece" data-piece-id="M03"><img src="images/M03.png" alt="匠心碎片3" loading="lazy"></div>
                    <div class="map-piece" data-piece-id="M04"><img src="images/M04.png" alt="匠心碎片4" loading="lazy"></div>
                    <div class="map-piece" data-piece-id="M05"><img src="images/M05.png" alt="匠心碎片5" loading="lazy"></div>
                    <div class="map-piece" data-piece-id="M06"><img src="images/M06.png" alt="匠心碎片6" loading="lazy"></div>
                </div>
                <p class="progress-text">匠心碎片：<span id="map-progress-text">0 / 6</span> 片</p>
            </section>

            <section id="compass-section">
                <h2>微笑之心</h2>
                <div id="compass-container">
                    <img src="images/heart-base.png" alt="心形底座" class="compass-image">
                    <div id="compass-progress-bar"></div>
                    <img src="images/smile-logo.png" alt="微笑標誌底色" class="compass-image logo-dim">
                    <img src="images/smile-logo.png" alt="微笑標誌" class="compass-image logo-vivid">
                </div>
                <p class="progress-text">信賴指數：<span id="compass-progress-text">0 / 1500</span></p>
            </section>
        </main>

        <section id="redemption-info">
            <h2>遊戲流程 & 兌換說明</h2>
            <div class="redemption-content">
                <p><strong>最終目標：</strong><br>當「匠心地圖」完整（集滿6片）並且「微笑之心」的信賴指數累積滿 1500 時，您就達成了最終目標！</p>
                <p><strong>兌換獎品：</strong><br>達成目標後，您將有資格兌換我們為您準備的活動紀念獎。</p>
                <ul><li>一份充滿心意的**「傳承之禮」**</li><li>它象徵著您對在地品牌的信賴與支持</li></ul>
                <p><strong>如何兌換：</strong><br>當您在網頁上看到勝利畫面後，即可點擊按鈕產生專屬兌換碼，並親至「大會服務台」，向工作人員出示您手機上的 QR Code 畫面，核對無誤後即可兌換。</p>
                <button id="redeem-button" style="display: none; margin: 20px auto; font-size: 1.2em; padding: 12px 25px; cursor: pointer; border-radius: 8px; border: none; background-color: #4caf50; color: white;">點此產生兌換 QR Code</button>
                <p class="prize-notice">※ 請注意：每日獎品數量有限，兌完為止，敬請把握！</p>
            </div>
        </section>

        <footer id="important-notes">
            <h3>重要注意事項</h3>
            <ul>
                <li><strong>【遊戲紀錄提醒】</strong><br>您的遊戲進度採「匿名方式」儲存於「目前這台手機的瀏覽器」中。為避免紀錄遺失，請勿使用無痕模式、清除快取(Cache)或更換手機/瀏覽器參與活動。</li>
                <li><strong>【資料遺失聲明】</strong><br>因採匿名設計，若紀錄因上述操作遺失，我們將無法為您查詢或回復，敬請見諒。</li>
                <li><strong>【獎品兌換須知】</strong><br>每日獎品數量有限，兌完為止。建議達成目標後儘速兌換。</li>
            </ul>
        </footer>

        <div id="purchase-modal" class="modal-overlay" style="display: none;">
            <div class="modal-content">
                <h3 id="modal-store-name">在店家消費</h3>
                <p>感謝您對本店的信賴，請輸入支持金額：</p>
                <input type="number" id="amount-input" placeholder="例如：350" inputmode="numeric">
                <button id="submit-amount-button">累積信賴</button>
                <button id="cancel-button">取消</button>
            </div>
        </div>
        
        <div id="custom-alert-modal" class="modal-overlay" style="display: none;">
            <div class="modal-content">
                <p id="custom-alert-message" style="margin-bottom: 20px; font-size: 1.2em;"></p>
                <div id="qrcode-container" style="margin: 20px auto; width: 180px; height: 180px; background: white; padding: 10px; box-sizing: content-box;"></div>
                <button id="custom-alert-ok-button">確定</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/davidshimjs-qrcodejs@0.0.2/qrcode.min.js"></script>
</body>
</html>
